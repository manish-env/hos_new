{% comment %}
  Mx – Collection List (bottom-centered title + grow-from-center border hover, no radius)
{% endcomment %}

<section class="mx-coll-list" style="--mx-cols-d: {{ section.settings.columns_desktop }}; --mx-cols-m: {{ section.settings.columns_mobile }}; --mx-gap: {{ section.settings.gap }}px;">
  <div class="mx-wrap {% if section.settings.full_width %}mx-wide{% else %}mx-contained{% endif %}">
    {% if section.settings.heading != blank %}
      <h2 class="mx-hdg">{{ section.settings.heading }}</h2>
    {% endif %}

    <div class="mx-grid">
      {% for block in section.blocks %}
        {% assign coll = block.settings.collection %}
        {% if coll != blank %}
          <a
            class="mx-card"
            href="{{ coll.url }}"
            {{ block.shopify_attributes }}
          >
            <div class="mx-imgwrap {% if section.settings.cover %}mx-cover{% else %}mx-contain{% endif %}">
              {% assign img = block.settings.image | default: coll.image %}
              {% if img != blank %}
                {{ img | image_url: width: 1200 | image_tag: loading: 'lazy', sizes: '(min-width: 990px) 25vw, 50vw', class: 'mx-img' }}
              {% else %}
                {{ 'collection-1' | placeholder_svg_tag: 'mx-ph' }}
              {% endif %}

              {%- comment -%} Grow-from-center lines (2px) on all four sides {%- endcomment -%}
              <span class="mx-line top"></span>
              <span class="mx-line right"></span>
              <span class="mx-line bottom"></span>
              <span class="mx-line left"></span>

              <div class="mx-bottom">
                <span class="mx-title">
                  {{ block.settings.custom_title | default: coll.title }}
                </span>
              </div>
            </div>
          </a>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<style>
  .mx-coll-list{--mx-gap:16px; --mx-cols-d:3; --mx-cols-m:2}
  .mx-wrap{padding: clamp(12px, 2vw, 24px) 0}
  .mx-contained{max-width: var(--page-width, 1200px); margin: 0 auto; padding: 0 16px}
  .mx-wide{width: 100%}
  .mx-hdg{margin: 0 0 12px; text-align: center; font-weight: 600; letter-spacing:.02em}

  .mx-grid{
    display: grid;
    gap: var(--mx-gap);
    grid-template-columns: repeat(var(--mx-cols-m), 1fr);
  }
  @media (min-width: 750px){
    .mx-grid{ grid-template-columns: repeat(var(--mx-cols-d), 1fr); }
  }

  .mx-card{ display:block; text-decoration:none; color:inherit }
  .mx-imgwrap{
    position: relative; overflow: hidden; border-radius: 0; /* no radius */
    aspect-ratio: 4/5; background: #f6f6f6;
    color:#ffffff; /* line color (white over photo) */
  }
  .mx-imgwrap.mx-cover .mx-img{ width:100%; height:100%; object-fit:cover; display:block }
  .mx-imgwrap.mx-contain .mx-img{ width:100%; height:100%; object-fit:contain; display:block; background:#fff }
  .mx-ph{width:100%; height:100%; display:block; background:#fafafa}

  /* Bottom overlay + centered title at bottom */
  .mx-bottom{
    position:absolute; left:0; right:0; bottom:0;
    padding: 16px 10px 18px;
    display:flex; justify-content:center;
  }
  .mx-bottom::before{
    content:""; position:absolute; inset:auto 0 0 0; height:48%;
    background: linear-gradient(180deg, rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 100%);
    pointer-events:none;
  }
  .mx-title{
    position:relative; z-index:1;
    font-size: clamp(14px, 2.2vw, 18px);
    font-weight: 700; letter-spacing:.06em; text-transform: uppercase;
    color:#fff; text-align:center;
  }

  /* Grow-from-center border lines (2px), meeting at corners simultaneously */
  .mx-line{ position:absolute; display:block; background: currentColor; pointer-events:none; opacity:1; }
  .mx-line.top,
  .mx-line.bottom{
    height:2px; left:0; right:0;
    transform: scaleX(0); transform-origin:center;
  }
  .mx-line.left,
  .mx-line.right{
    width:2px; top:0; bottom:0;
    transform: scaleY(0); transform-origin:center;
  }
  .mx-line.top{ top:0; }
  .mx-line.bottom{ bottom:0; }
  .mx-line.left{ left:0; }
  .mx-line.right{ right:0; }

  /* Animate all sides together so they join neatly at corners */
  .mx-card:hover .mx-line.top,
  .mx-card:focus-visible .mx-line.top,
  .mx-card:hover .mx-line.bottom,
  .mx-card:focus-visible .mx-line.bottom{
    transition: transform .35s ease; transform: scaleX(1);
  }
  .mx-card:hover .mx-line.left,
  .mx-card:focus-visible .mx-line.left,
  .mx-card:hover .mx-line.right,
  .mx-card:focus-visible .mx-line.right{
    transition: transform .35s ease; transform: scaleY(1);
  }

  /* Optional subtle lift */
  .mx-card .mx-imgwrap{ transition: transform .35s ease }
  .mx-card:hover .mx-imgwrap{ transform: translateY(-2px) }
</style>

{% schema %}
{
  "name": "Mx • Collection",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Shop by Category" },
    { "type": "checkbox", "id": "full_width", "label": "Full width", "default": false },
    { "type": "range", "id": "columns_desktop", "label": "Columns on desktop", "min": 2, "max": 5, "step": 1, "default": 4 },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Columns on mobile",
      "default": "2",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" }
      ]
    },
    { "type": "range", "id": "gap", "label": "Card gap (px)", "min": 0, "max": 40, "step": 2, "default": 16 },
    { "type": "checkbox", "id": "cover", "label": "Image fit: cover (else contain)", "default": true }
  ],
  "blocks": [
    {
      "type": "collection",
      "name": "Collection",
      "settings": [
        { "type": "collection", "id": "collection", "label": "Collection" },
        { "type": "image_picker", "id": "image", "label": "Custom image (optional)" },
        { "type": "text", "id": "custom_title", "label": "Custom title (optional)" }
      ]
    }
  ],
  "max_blocks": 12,
  "presets": [
    { "name": "Mx Collections", "category": "Collections" }
  ]
}
{% endschema %}
