{% comment %}
  Mx Navbar – Primary (Search L, Logo C, Auth/Wishlist/Cart R)
  + Secondary centered nav with MEGA dropdown (centered under parent, 4 cols + right promo image)
  + Three tabs bar
{% endcomment %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
  :root{
    --hdr-text:#111;
    --hdr-muted:#666;
    --hdr-accent:#ff4aa2;
    --hdr-bg:#fff;
    --border:#eee;
    --transition: all 0.3s ease;
    --header-height: 80px; /* Reduced header height */
  }

  /* Prevent content from being hidden behind sticky header */
  body { 
    scroll-behavior: smooth;
  }
  
  /* Add minimal padding to main content to account for sticky header */
  main, .main-content, .page-content {
    padding-top: 20px;
  }
  
  /* Only add padding to first section if needed */
  .shopify-section:first-child {
    padding-top: 20px;
  }
  


  .cw-header{position:fixed; top:0; left:0; right:0; background:var(--hdr-bg); color:var(--hdr-text); border-bottom:1px solid var(--border); z-index:1000; width:100%;}
  .cw-container{max-width:1400px; margin:0 auto;}

  /* PRIMARY BAR */
  .cw-primary{display:grid; grid-template-columns:1fr auto 1fr; align-items:center; gap:16px; height:80px; padding:15px;}

  /* SEARCH: square, no box border, mail icon + divider + static underline */
  .cw-search{display:flex; align-items:center; max-width:420px; position:relative;}
  .cw-search form{width:100%; display:flex; align-items:center; gap:10px;}
  .cw-search .mail{font-size:18px; color:#333; display:inline-flex; align-items:center; justify-content:center;}
  .cw-search .divider{width:1px; height:18px; background:#bdbdbd; display:inline-block;}
  .cw-search input{
    flex:1 1 auto; height:32px; padding:0 8px; border:none; border-radius:0; background:transparent; outline:none;
    font-size:14px; color:#111;
  }
  .cw-search button{border:none; background:transparent; cursor:pointer; font-size:18px; color:#333; padding:0; display:inline-flex; align-items:center;}
  .cw-search:after{content:""; position:absolute; left:0; right:0; bottom:-6px; height:2px; background:#111;}

  /* LOGO */
  .cw-logo{display:flex; justify-content:center;}
  .cw-logo a{display:inline-flex; align-items:center; gap:10px; text-decoration:none; color:inherit;}
  .cw-logo img{max-height:44px; display:block;}
  .cw-logo .text{font-size:28px; font-weight:600; letter-spacing:.5px;}

  /* RIGHT SIDE */
  .cw-right{display:flex; gap:18px; justify-content:flex-end; align-items:center;}
  .cw-right a{color:var(--hdr-text); text-decoration:none; font-size:14px;}
  .cw-icons{display:flex; gap:14px; align-items:center;}
  .cw-icons a{position:relative; font-size:18px; color:var(--hdr-text);}
  .cw-cart-count, .cart-count{
    position:absolute; top:-6px; right:-8px; min-width:16px; height:16px; border-radius:999px;
    background:var(--hdr-accent); color:#fff; font-size:11px; line-height:16px; text-align:center; padding:0 4px;
  }

  /* SECONDARY BAR */
  .cw-secondary{border-top:1px solid var(--border); border-bottom:1px solid var(--border); overflow:visible;}
  .cw-secondary .cw-container{display:flex; justify-content:center; position:relative;}
  .cw-nav-wrap{width:100%; display:flex; justify-content:center;}
  .cw-nav{
    display:flex; align-items:center; gap:28px; white-space:nowrap; padding:0; margin:0; list-style:none;
  }
  .cw-nav > li{position:static; list-style:none;}
  .cw-nav > li > a{
    display:inline-block; padding:14px 0; text-decoration:none; color:var(--hdr-text);
    font-size:14px; font-weight:500;
  }
  /* No underline/active effects on links */
  .cw-nav > li > a::after{display:none !important;}

  /* MEGA DROPDOWN — CENTERED UNDER PARENT <li> (not full width) */
  .cw-mega{
    position:absolute;
    top:100%;
    left:0;
    right:0;
    width:100%;
    background:#fff;
    border-top:1px solid #f0f0f0;
    display:none;
    z-index:1001;
    box-shadow:0 12px 28px rgba(0,0,0,.08);
    padding:18px 20px;
    opacity:0;
    visibility:hidden;
    transition:var(--transition);
  }
  
  /* Center the mega menu content */
  .cw-mega-inner-container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
  }
  
  .cw-nav > li:hover .cw-mega{
    display:block;
    opacity:1;
    visibility:visible;
  }

  /* MEGA GRID: 4 cols + right promo image */
  .cw-mega-inner{
    display:grid; 
    grid-template-columns:repeat(4, minmax(0,1fr)) 300px; 
    gap:28px;
    width:100%;
    max-width:1200px;
  }
  .cw-mega .col-title{margin:0 0 10px; font-size:12.5px; color:var(--hdr-muted); text-transform:uppercase; letter-spacing:.04em; font-weight:600;}
  .cw-mega .col-title-wrap{position:relative; padding-top:12px;}
  .cw-mega .col-title-wrap:before{content:""; position:absolute; left:0; top:0; width:160px; height:2px; background:#dcdcdc;}

  .cw-mega .links a{display:block; padding:7px 0; text-decoration:none; color:var(--hdr-text); font-size:14px; transition:var(--transition);}
  .cw-mega .links a:hover{color:var(--hdr-accent); transform:translateX(5px);}

  /* Promo image (right) */
  .cw-mega-media a{display:block; overflow:hidden;}
  .cw-mega-media img{width:100%; height:auto; display:block; object-fit:cover; border:1px solid #eee; transition:var(--transition);}
  .cw-mega-media a:hover img{transform:scale(1.03);}

  /* "Shop by Color" swatches (optional column) */
  .cw-swatches{display:grid; grid-template-columns:repeat(7, 22px); gap:10px; padding-top:6px;}
  .cw-swatch{width:22px; height:22px; border:1px solid #cfcfcf; box-shadow:inset 0 0 0 1px rgba(255,255,255,.15); transition:var(--transition);}
  .cw-swatch:hover{transform:scale(1.2);}
  .cw-swatch.is-white{border-color:#999;}
  .cw-swatch-link{display:block; width:22px; height:22px;}

  /* Special labels */
  .cw-nav > li.badge-fast > a{color:#ff32aa;}
  .cw-nav > li.badge-outlet > a{
    padding:8px 10px; border:1px solid #f5dfe8; background:#fdf0f5; border-radius:4px;
    line-height:1; margin-top:6px; margin-bottom:6px;
  }

  /* THREE TABS */
  .cw-tabs{display:grid; grid-template-columns:repeat(3,1fr); gap:0;}
  .cw-tab{border:none; border-radius:0; padding:12px; font-size:13px; text-decoration:none; color:var(--hdr-text); text-align:center; transition:var(--transition);}
  .cw-tab:nth-child(1){background:#efefef;} .cw-tab:nth-child(2){background:#ffecee;} .cw-tab:nth-child(3){background:#efefef;}
  .cw-tab:hover{color:var(--hdr-accent); background:rgba(0,0,0,0.05);}

  /* BURGER MENU */
  .cw-burger{display:none; align-items:center; gap:8px; font-size:24px; cursor:pointer; background:none; border:none; color:var(--hdr-text);}
  
  /* RESPONSIVE */
  @media (max-width: 1200px){
    .cw-mega-inner{grid-template-columns:repeat(3,minmax(0,1fr)) 260px;}
  }
  
  @media (max-width: 990px){
    .cw-primary{grid-template-columns: 1fr auto 1fr; height:72px;}
    .cw-mega-inner{grid-template-columns:repeat(2,minmax(0,1fr));}
    .cw-tabs{grid-template-columns:1fr;}
    
    /* Adjust header height for mobile */
    :root { --header-height: 180px; }
    
         /* Mobile menu styling */
     .cw-burger{display:flex;}
     .cw-nav-wrap{
       display:none;
       position:absolute;
       top:100%;
       left:0;
       width:80%;
       background:var(--hdr-bg);
       z-index:1001;
       padding:20px;
       box-shadow:0 5px 15px rgba(0,0,0,0.1);
       border-top:1px solid var(--border);
       border-right:1px solid var(--border);
       height:100vh;
       overflow-y:auto;
       transition:var(--transition);
     }
         .cw-nav-wrap.open{display:block;}
     
     /* Mobile drawer header */
     .cw-drawer-header{
       display:flex;
       justify-content:space-between;
       align-items:center;
       padding:20px 20px 15px 20px;
       border-bottom:1px solid var(--border);
       margin:-20px -20px 0 -20px;
       background:var(--hdr-bg);
     }
     .cw-drawer-header h3{
       margin:0;
       font-size:18px;
       font-weight:600;
       color:var(--hdr-text);
     }
     .cw-close-drawer{
       background:none;
       border:none;
       font-size:20px;
       color:var(--hdr-text);
       cursor:pointer;
       padding:0;
       display:flex;
       align-items:center;
       justify-content:center;
     }
     
       
     
     .cw-nav{flex-direction:column; align-items:flex-start; gap:0; margin-top:10px;}
     .cw-nav > li{width:100%;}
     .cw-nav > li > a{display:block; padding:15px 0; width:100%; border-bottom:1px solid #f5f5f5; font-size:16px; font-weight:500;}
    
    /* Mobile mega menu */
    .cw-nav > li:hover .cw-mega{display:none;} /* Disable hover on mobile */
    .cw-mega{
      position:static;
      width:100%;
      box-shadow:none;
      border:none;
      padding:10px 0 10px 15px;
      display:none;
      opacity:1;
      visibility:visible;
    }
    .cw-mega.open{display:block;}
    .cw-mega-inner{grid-template-columns:1fr; gap:14px;}
    .cw-mega-media{order:-1;} /* Move promo image to top on mobile */
    
    /* Mobile color swatches */
    .cw-swatches{grid-template-columns:repeat(5, 22px);}
  }
  
  @media (max-width: 768px){
    .cw-primary{grid-template-columns: auto 1fr auto; gap:10px; height:60px;padding:15px; !important}
    .cw-search{display:none;} /* Hide search in primary bar on mobile */
    .cw-logo{order:2; justify-content:center;}
    .cw-right{order:3; justify-content:flex-end;}
    
    /* Show burger menu on left */
    .cw-burger{display:flex; order:1; justify-content:flex-start;}
    
    /* Adjust header height for smaller mobile */
    :root { --header-height: 160px; }
    
    /* Adjust tabs for mobile */
    .cw-tabs{grid-template-columns:1fr; gap:5px;}
    .cw-tab{padding:10px; font-size:12px;}
    
    
  }
  
  @media (max-width: 480px){
    .cw-primary{height:60px;}
    .cw-logo .text{font-size:20px;}
    .cw-logo img{max-height:36px;}
    .cw-right a{font-size:12px;}
    .cw-icons a{font-size:16px;}
    
    /* Adjust search for very small screens */
    .cw-search .mail{font-size:16px;}
    .cw-search input{font-size:13px;}
  }
</style>

<header class="cw-header">
  <!-- PRIMARY NAVBAR -->
  <div class="cw-container">
    <div class="cw-primary">
      <!-- Left: Burger Menu (mobile) / Search (desktop) -->
      <button class="cw-burger" aria-controls="cw-nav" aria-expanded="false">
        <i class="fa-solid fa-bars"></i>
      </button>
      <div class="cw-search">
        <form action="{{ routes.search_url }}" method="get" role="search" aria-label="Site search">
          <span class="mail"><i class="fa-regular fa-envelope"></i></span>
          <span class="divider"></span>
          <input type="search" name="q" placeholder="Search Your Style" value="{{ search.terms | escape }}" autocomplete="off">
          <button aria-label="Search"><i class="fa-solid fa-magnifying-glass"></i></button>
          <input type="hidden" name="type" value="product">
        </form>
      </div>

      <!-- Center: Logo -->
      <div class="cw-logo">
        <a href="{{ routes.root_url }}">
          {% if section.settings.logo != blank %}
            <img src="{{ section.settings.logo | img_url: '200x' }}" alt="{{ shop.name }}">
          {% else %}
            <span class="text">{{ shop.name }}</span>
          {% endif %}
        </a>
      </div>

             <!-- Right: Account / Wishlist / Cart -->
       <div class="cw-right">
         <div class="cw-icons">
           {% if customer %}
             <a href="{{ routes.account_url }}" aria-label="Account"><i class="fa-regular fa-user"></i></a>
           {% else %}
             <a href="{{ routes.account_login_url }}" aria-label="Login"><i class="fa-regular fa-user"></i></a>
           {% endif %}
           {% if section.settings.wishlist_url != blank %}
             <a href="{{ section.settings.wishlist_url }}" aria-label="Wishlist"><i class="fa-regular fa-heart"></i></a>
           {% endif %}
           <a href="{{ routes.cart_url }}" aria-label="Cart">
             <i class="fa-solid fa-bag-shopping"></i>
             {% if cart.item_count > 0 %}
               <span class="cw-cart-count">{{ cart.item_count }}</span>
             {% endif %}
           </a>
         </div>
       </div>
    </div>
  </div>



  <!-- SECONDARY NAVBAR + MEGA MENU -->
  <div class="cw-secondary">
    <div class="cw-container">
      <div class="cw-secondary-inner">
        <nav id="cw-nav" class="cw-nav-wrap">
          {% assign nav = section.settings.main_menu %}
          {% if nav != blank %}
            <ul class="cw-nav" role="list">
              {% for top in nav.links %}
                {% assign extra_class = '' %}
                {% if top.title == 'FAST SHIP' %}
                  {% assign extra_class = 'badge-fast' %}
                {% elsif top.title == 'OUTLET' %}
                  {% assign extra_class = 'badge-outlet' %}
                {% endif %}
                <li class="{{ extra_class }}">
                  <a href="{{ top.url }}">{{ top.title }}{% if top.links.size > 0 %} <i class="fas fa-chevron-down" style="font-size:10px; margin-left:5px;"></i>{% endif %}</a>

                  {% if top.links.size > 0 %}
                    <div class="cw-mega">
                      <div class="cw-mega-inner-container">
                        <div class="cw-mega-inner">
                          {%- comment -%} LEFT 4 COLUMNS {%- endcomment -%}
                          {% for col in top.links limit:4 %}
                            <div class="cw-mega-col">
                              <div class="col-title-wrap">
                                <h4 class="col-title">{{ col.title }}</h4>
                              </div>

                              {% assign is_color_column = false %}
                              {% if col.title %}
                                {% assign up = col.title | strip | upcase %}
                                {% if up == 'SHOP BY COLOR' %}
                                  {% assign is_color_column = true %}
                                {% endif %}
                              {% endif %}

                              {% if is_color_column %}
                                <div class="cw-swatches">
                                  {% for leaf in col.links %}
                                    {% assign color_text = leaf.title | strip %}
                                    {% assign color_val = color_text %}
                                    {% capture style_bg %}background: {{ color_val }};{% endcapture %}

                                    {% assign lc = color_val | downcase | strip %}
                                    {% assign is_white = false %}
                                    {% if lc == 'white' or lc == '#fff' or lc == '#ffffff' %}
                                      {% assign is_white = true %}
                                    {% endif %}

                                    <a class="cw-swatch-link" href="{{ leaf.url }}" title="{{ color_text }}">
                                      <span class="cw-swatch{% if is_white %} is-white{% endif %}" style="{{ style_bg }}"></span>
                                    </a>
                                  {% endfor %}
                                </div>
                              {% else %}
                                <div class="links">
                                  {% if col.links.size > 0 %}
                                    {% for leaf in col.links %}
                                      <a href="{{ leaf.url }}">{{ leaf.title }}</a>
                                    {% endfor %}
                                  {% else %}
                                    <a href="{{ col.url }}">{{ col.title }}</a>
                                  {% endif %}
                                </div>
                              {% endif %}
                            </div>
                          {% endfor %}

                          {%- comment -%} RIGHT PROMO IMAGE (global; optional) {%- endcomment -%}
                          {% if section.settings.mega_image != blank %}
                            <div class="cw-mega-media">
                              {% if section.settings.mega_image_link != blank %}<a href="{{ section.settings.mega_image_link }}">{% endif %}
                                <img src="{{ section.settings.mega_image | img_url: '400x' }}" alt="Mega promo">
                              {% if section.settings.mega_image_link != blank %}</a>{% endif %}
                            </div>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                  {% endif %}
                </li>
              {% endfor %}
            </ul>
          {% else %}
            <p style="padding:14px 0; color:var(--hdr-muted);">Select a menu in section settings.</p>
          {% endif %}
        </nav>
      </div>
    </div>
  </div>

  <!-- THREE TABS BAR -->
  <div class="cw-container">
    <div class="cw-tabs" role="navigation" aria-label="Quick links">
      {% if section.settings.tab1_text != blank %}
        <a class="cw-tab" href="{{ section.settings.tab1_link }}">{{ section.settings.tab1_text }}</a>
      {% endif %}
      {% if section.settings.tab2_text != blank %}
        <a class="cw-tab" href="{{ section.settings.tab2_link }}">{{ section.settings.tab2_text }}</a>
      {% endif %}
      {% if section.settings.tab3_text != blank %}
        <a class="cw-tab" href="{{ section.settings.tab3_link }}">{{ section.settings.tab3_text }}</a>
      {% endif %}
    </div>
  </div>
</header>

<script>
  (function(){
         // Mobile menu toggle
     var burger = document.querySelector('.cw-burger');
     var wrap = document.querySelector('.cw-nav-wrap');
     
     if(burger && wrap) {
       burger.addEventListener('click', function(){
         wrap.classList.toggle('open');
         var expanded = burger.getAttribute('aria-expanded') === 'true';
         burger.setAttribute('aria-expanded', String(!expanded));
       });
     }
    
    // Mobile submenu toggle
    var navItems = document.querySelectorAll('.cw-nav > li');
    navItems.forEach(function(item) {
      if(item.querySelector('.cw-mega')) {
        var link = item.querySelector('a');
        link.addEventListener('click', function(e) {
          if(window.innerWidth <= 990) {
            e.preventDefault();
            var mega = item.querySelector('.cw-mega');
            mega.classList.toggle('open');
          }
        });
      }
    });
    
         // Close menu when clicking outside
     document.addEventListener('click', function(e) {
       if(wrap && wrap.classList.contains('open') && !e.target.closest('.cw-nav-wrap') && !e.target.closest('.cw-burger')) {
         wrap.classList.remove('open');
         burger.setAttribute('aria-expanded', 'false');
       }
     });
  })();
</script>

{% schema %}
{
  "name": "Mx Navbar",
  "settings": [
    { "type": "image_picker", "id": "logo", "label": "Logo" },
    { "type": "link_list", "id": "main_menu", "label": "Secondary menu (mega)", "default": "main-menu" },
    { "type": "url", "id": "wishlist_url", "label": "Wishlist URL (optional)" },

    { "type": "image_picker", "id": "mega_image", "label": "Mega promo image (right side)" },
    { "type": "url", "id": "mega_image_link", "label": "Mega promo link (optional)" },

    { "type": "text", "id": "tab1_text", "label": "Tab 1 text", "default": "PERFECT TAILORING , DELIVERED AT DOORSTEPS" },
    { "type": "url", "id": "tab1_link", "label": "Tab 1 link" },

    { "type": "text", "id": "tab2_text", "label": "Tab 2 text", "default": "FREE DELIVERY ACROSS INDIA" },
    { "type": "url", "id": "tab2_link", "label": "Tab 2 link" },

    { "type": "text", "id": "tab3_text", "label": "Tab 3 text", "default": "TRENDIEST TOP QUALITY DRESSES" },
    { "type": "url", "id": "tab3_link", "label": "Tab 3 link" }
  ],
  "blocks": [],
  "presets": [{ "name": "Mx Navbar" }]
}
{% endschema %}