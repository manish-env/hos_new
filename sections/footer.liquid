{% comment %}
  Section: MX Footer Utilities (Page-Width, 20/60/20)
  - Desktop (>=992px): 20% Socials | 60% Badges (centered) | 20% Subscribe
  - Mobile: Badges → Subscribe → Socials (stacked)
  - Uses Font Awesome 6 (free) for icons
{% endcomment %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<section class="mx-footer-utils" style="background: {{ section.settings.bg | default: '#f5f5f5' }};">
  <!-- Use theme container so it never overflows -->
  <div class="mx-fw page-width">

    <!-- SOCIALS (20%) -->
    <div class="mx-socials" aria-label="Social links">
      {%- if section.settings.facebook_url != blank -%}
        <a class="mx-social" href="{{ section.settings.facebook_url }}" target="_blank" rel="noopener" aria-label="Facebook">
          <i class="fa-brands fa-facebook-f" aria-hidden="true"></i>
        </a>
      {%- endif -%}
      {%- if section.settings.blog_url != blank -%}
        <a class="mx-social" href="{{ section.settings.blog_url }}" aria-label="Blog">
          <i class="fa-solid fa-rss" aria-hidden="true"></i>
        </a>
      {%- endif -%}
      {%- if section.settings.instagram_url != blank -%}
        <a class="mx-social" href="{{ section.settings.instagram_url }}" target="_blank" rel="noopener" aria-label="Instagram">
          <i class="fa-brands fa-instagram" aria-hidden="true"></i>
        </a>
      {%- endif -%}
      {%- if section.settings.youtube_url != blank -%}
        <a class="mx-social" href="{{ section.settings.youtube_url }}" target="_blank" rel="noopener" aria-label="YouTube">
          <i class="fa-brands fa-youtube" aria-hidden="true"></i>
        </a>
      {%- endif -%}
    </div>

    <!-- BADGES (60%) -->
    <div class="mx-badges" aria-label="Trust badges">
      {%- for block in section.blocks -%}
        {%- if block.type == 'badge' -%}
          <div class="mx-badge" {{ block.shopify_attributes }}>
            <i class="fa-solid {{ block.settings.icon | escape }}" aria-hidden="true"></i>
            <span class="mx-badge-text">{{ block.settings.label | escape }}</span>
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>

    <!-- SUBSCRIBE (20%) -->
    <div class="mx-subscribe">
      {%- form 'customer', id: 'mx-newsletter' -%}
        <input type="hidden" name="contact[tags]" value="newsletter">
        <label class="sr-only" for="mx-newsletter-email">
          {{ 'newsletter.label' | t | default: 'Enter your email address' }}
        </label>

        <div class="mx-input-wrap">
          <input
            id="mx-newsletter-email"
            class="mx-input"
            type="email"
            name="contact[email]"
            value="{{ form.email }}"
            placeholder="{{ section.settings.placeholder | escape }}"
            required
          >
          <button class="mx-btn" type="submit">{{ section.settings.button_label }}</button>
        </div>

        {%- if form.posted_successfully? -%}
          <p class="mx-msg mx-success">{{ section.settings.success_msg }}</p>
        {%- elsif form.errors -%}
          <p class="mx-msg mx-error">
            {{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}
          </p>
        {%- endif -%}
      {%- endform -%}
    </div>

  </div>
</section>

<style>
  .mx-footer-utils{
    color:#111;
    border-top:1px solid #eaeaea;
    box-sizing:border-box;
  }
  .mx-footer-utils, .mx-footer-utils *{ box-sizing: border-box; }

  /* page-width wrapper (theme controls width/padding) */
  .mx-fw.page-width{
    display:grid;
    grid-template-columns: 1fr; /* mobile stack */
    gap:20px;
    align-items:center;
    padding-top:18px; padding-bottom:18px; /* gentle vertical space */
    width:100%;
    max-width:100%;
    overflow-x: clip; /* prevent accidental horizontal scroll */
  }

  /* Mobile order: Badges → Subscribe → Socials */
  .mx-badges{order:1;}
  .mx-subscribe{order:2;}
  .mx-socials{order:3;}

  /* Socials */
  .mx-socials{display:flex; gap:18px; align-items:center; justify-content:flex-start; flex-wrap:wrap;}
  .mx-social{display:inline-flex; width:36px; height:36px; border:1px solid #cfcfcf; align-items:center; justify-content:center;}
  .mx-social i{font-size:16px;}

  /* Badges (center column) */
  .mx-badges{
    display:grid;
    grid-template-columns: repeat(3, minmax(0,1fr));
    gap:24px;
    place-items:center; /* center icon + text blocks perfectly */
    text-align:center;
  }
  .mx-badge{display:flex; flex-direction:column; align-items:center; gap:8px;}
  .mx-badge i{font-size:34px;}
  .mx-badge-text{font-size:14px; line-height:1.2; color:#333; text-transform:uppercase; letter-spacing:.02em;}

  /* Subscribe */
  .mx-subscribe{display:flex; flex-direction:column; gap:8px;}
  .mx-input-wrap{display:flex; align-items:center; width:100%; min-width:0; flex-wrap: nowrap;}
  .mx-input{
    height:44px; padding:0 12px; border:1px solid #cfcfcf; background:#fff;
    flex:1 1 0%; min-width:0; max-width:100%;
  }
  .mx-btn{
    height:44px; padding:0 16px; border:none; background:#111; color:#fff; cursor:pointer;
    margin-left:8px; white-space:nowrap; flex:0 0 auto;
  }
  .mx-msg{font-size:13px; margin-top:6px}
  .mx-success{color:#17803d}
  .mx-error{color:#b00020}
  .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}

  /* Desktop split: 20% | 60% | 20% inside page width */
  @media (min-width: 992px){
    .mx-fw.page-width{
      grid-template-columns: minmax(0,20%) minmax(0,60%) minmax(0,20%);
      gap:24px;
    }
    .mx-socials{order:1; justify-content:flex-start;}
    .mx-badges{order:2;}
    .mx-subscribe{order:3; align-items:flex-end;}
    .mx-input-wrap{max-width:420px; width:100%;}
  }

  /* Wider screens: allow 4–5 badges gracefully if you add more blocks */
  @media (min-width: 1280px){
    .mx-badges{grid-template-columns: repeat(5, minmax(0,1fr));}
  }

  /* Extra safety for very narrow viewports: allow input/button to wrap */
  @media (max-width: 360px){
    .mx-input-wrap{flex-wrap: wrap;}
    .mx-btn{margin-left:0; margin-top:8px; width:100%;}
  }
</style>

{% schema %}
{
  "name": "MX Footer Utilities (Page Width)",
  "settings": [
    { "type": "color", "id": "bg", "label": "Background color", "default": "#f5f5f5" },
    { "type": "text", "id": "placeholder", "label": "Email placeholder", "default": "Enter your email address" },
    { "type": "text", "id": "button_label", "label": "Button label", "default": "SUBSCRIBE" },
    { "type": "text", "id": "success_msg", "label": "Success message", "default": "Thanks for subscribing!" },

    { "type": "url", "id": "facebook_url", "label": "Facebook URL" },
    { "type": "url", "id": "instagram_url", "label": "Instagram URL" },
    { "type": "url", "id": "youtube_url", "label": "YouTube URL" },
    { "type": "url", "id": "blog_url", "label": "Blog URL" }
  ],
  "blocks": [
    {
      "type": "badge",
      "name": "Badge",
      "settings": [
        { "type": "text", "id": "icon", "label": "FA icon (without 'fa-solid ')", "default": "fa-truck-fast" },
        { "type": "text", "id": "label", "label": "Label", "default": "Track Order" }
      ]
    }
  ],
  "max_blocks": 8,
  "presets": [
    {
      "name": "MX Footer Utilities (Page Width)",
      "blocks": [
        { "type": "badge", "settings": { "icon": "fa-truck-fast", "label": "Track Order" } },
        { "type": "badge", "settings": { "icon": "fa-globe", "label": "International Delivery" } },
        { "type": "badge", "settings": { "icon": "fa-scissors", "label": "Boutique Style Stitching" } }
      ]
    }
  ]
}
{% endschema %}
